name: ZenPacks.fednot.Delivery

zProperties:
  zSpringBootPort:
    category: SpringBoot
    type: int
    default: 8105
  zSpringBootApplications:
    category: SpringBoot
    type: lines

class_relationships:
  - SpringBootDevice 1:MC SpringBootApplication
  - SpringBootApplication 1:MC SpringBootComponent
  - SpringBootApplication 1:MC SpringBootJob
  - SpringBootApplication 1:MC SpringBootOrder
  - SpringBootApplication 1:MC SpringBootJVM

classes:
  SpringBootDevice:
    base: [zenpacklib.Device]
    label: SpringBoot Device

  SpringBootApplication:
    base: [zenpacklib.Component]
    label: Application
    monitoring_templates: [SpringBootApplication]
    properties:
      DEFAULTS:
        grid_display: false
      status:
        label: Status
        type: string
        datapoint: health_status
        renderer: Zenoss.render.severity
        grid_display: true
        label_width: 40
      statusString:
        label: Status Label
        type: string
        grid_display: false
      serviceName:
        label: serviceName
        grid_display: true
        label_width: 350
      healthURL:
        label: Health URL
        grid_display: false
      serviceURL:
        label: Service URL
        grid_display: false

  SpringBootComponent:
    base: [zenpacklib.Component]
    label: Application Component
    monitoring_templates: [SpringBootComponent]
    properties:
      DEFAULTS:
        grid_display: false
      status:
        label: Status
        type: string
        datapoint: health_status
        renderer: Zenoss.render.severity
        grid_display: true
        label_width: 40
      statusString:
        label: Status Label
        type: string
        grid_display: false
      serviceName:
        label: serviceName
        grid_display: true
        label_width: 350

  SpringBootJob:
    base: [zenpacklib.Component]
    label: Application Job
    properties:
      DEFAULTS:
        grid_display: false
      jobName:
        label: Job Name
        grid_display: true
      status:
        label: Status
        type: string
        datapoint: health_status
        renderer: Zenoss.render.severity
        grid_display: true
        label_width: 40
      statusString:
        label: Status Label
        type: string
        grid_display: false
      serviceName:
        label: serviceName
        grid_display: true
        label_width: 350

  SpringBootOrder:
    base: [zenpacklib.Component]
    label: Application Order
    properties:
      DEFAULTS:
        grid_display: false
      serviceName:
        label: serviceName
        grid_display: true
        label_width: 300

  SpringBootJVM:
    base: [zenpacklib.Component]
    label: Application JVM
    properties:
      DEFAULTS:
        grid_display: false
      serviceName:
        label: serviceName
        grid_display: true
        label_width: 300

device_classes:
  /Server/Linux/Applications:
    zProperties:
      zPythonClass: ZenPacks.fednot.Delivery.SpringBootDevice
      zCollectorPlugins:
        - fednot.json.Delivery
      zDeviceTemplates:
        - Device
      # TODO : Add more templates

    templates:
      SpringBootApplication:
        targetPythonClass: ZenPacks.fednot.Delivery.SpringBootApplication
        datasources:
          health:
            type: Python
            plugin_classname: ZenPacks.fednot.Delivery.dsplugins.health.Health
            datapoints:
              status:
                rrdtype: GAUGE

      SpringBootComponent:
        targetPythonClass: ZenPacks.fednot.Delivery.SpringBootComponent
        datasources:
          health:
            type: Python
            plugin_classname: ZenPacks.fednot.Delivery.dsplugins.health.Health
            datapoints:
              status:
                rrdtype: GAUGE

      SpringBootJob:
        targetPythonClass: ZenPacks.fednot.Delivery.SpringBootJob
        datasources:
          health:
            type: Python
            plugin_classname: ZenPacks.fednot.Delivery.dsplugins.jobs.Jobs
            datapoints:
              status:
                rrdtype: GAUGE

      SpringBootOrder:
        targetPythonClass: ZenPacks.fednot.Delivery.SpringBootOrder
        datasources:
          orders:
            type: Python
            plugin_classname: ZenPacks.fednot.Delivery.dsplugins.orders.Orders
            datapoints:
              uploaded:
                rrdtype: GAUGE

      SpringBootJVM:
        targetPythonClass: ZenPacks.fednot.Delivery.SpringBootJVM
        datasources:
          jvm:
            type: Python
            plugin_classname: ZenPacks.fednot.Delivery.dsplugins.jvm.JVM
            datapoints:
              classes_loaded:
                rrdtype: GAUGE
              classes_unloaded:
                rrdtype: GAUGE
              classes_loaded_total:
                rrdtype: GAUGE

